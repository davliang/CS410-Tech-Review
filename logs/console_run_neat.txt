PS C:\Projects\cs410-tech-review-final> uv run -m cs410_han
C:\Projects\cs410-tech-review-final\.venv\Lib\site-packages\cupy\_environment.py:216: UserWarning: CUDA path could not be detected. Set CUDA_PATH environment variable if CuPy fails to load.
  warnings.warn(
[05/06/25 03:03:54] INFO     Spacy model 'en_core_web_sm' loaded.                                                                                                                                                                                                                               data.py:37
                     INFO     Set random seed to 0                                                                                                                                                                                                                                           __main__.py:48
                     INFO     Using device: cuda                                                                                                                                                                                                                                           __main__.py:109
                     INFO     Loaded configuration: {'use_cache': True, 'embed_dim': 200, 'word_hidden_dim': 50, 'sent_hidden_dim': 50, 'num_classes': 5, 'learning_rate': 0.01, 'momentum': 0.9, 'batch_size': 64, 'num_epochs': 20, 'early_stopping_patience': 3, 'min_freq': 5, 'seed': 0, 'log_level': 'INFO'}  __main__.py:110
                     INFO     Data path: data\yelp-2015.json                                                                                                                                                                                                                               __main__.py:113
                     INFO     Model save directory: models                                                                                                                                                                                                                                 __main__.py:114
                     INFO     Cache directory: cache                                                                                                                                                                                                                                       __main__.py:115
                     INFO     Use cache: True                                                                                                                                                                                                                                              __main__.py:116
                     INFO     Loading full dataset...                                                                                                                                                                                                                                      __main__.py:122
                     INFO     Attempting to load data from: data\yelp-2015.json                                                                                                                                                                                                                 data.py:84
[05/06/25 03:04:01] INFO     Successfully loaded 1,569,264 reviews from data\yelp-2015.json                                                                                                                                                                                                   data.py:110
                     INFO     Splitting data into train (80%), validation (10%), test (10%)...                                                                                                                                                                                             __main__.py:127
                     INFO     Splitting 1,569,264 data points using seed 0...                                                                                                                                                                                                                  data.py:125
                     INFO     Split complete:                                                                                                                                                                                                                                                  data.py:140
                     INFO       Training set size:   1,255,412                                                                                                                                                                                                                                data.py:141
                     INFO       Validation set size: 156,927                                                                                                                                                                                                                                 data.py:142
                     INFO       Test set size:       156,925                                                                                                                                                                                                                                 data.py:143
                     INFO     Loading preprocessed tokenized data from cache directory: cache...                                                                                                                                                                                           __main__.py:146
[05/06/25 03:07:39] SUCCESS  Successfully loaded tokenized data from cache.                                                                                                                                                                                                                 __main__.py:153
                     INFO     Loaded/Processed 1,255,412 training examples.                                                                                                                                                                                                                __main__.py:187
                     INFO     Building vocabulary...                                                                                                                                                                                                                                       __main__.py:190
                     INFO     Building vocabulary from training data...                                                                                                                                                                                                                        data.py:183
Counting words... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:13
[05/06/25 03:07:52] INFO     Found 85,901 words with frequency >= 5                                                                                                                                                                                                                             data.py:203
[05/06/25 03:07:53] INFO     Total vocabulary size (including special tokens): 85,903                                                                                                                                                                                                           data.py:214
                     INFO     Vocabulary built with 85,903 words (min_freq=5).                                                                                                                                                                                                             __main__.py:196
                     INFO     Training Word2Vec embeddings...                                                                                                                                                                                                                              __main__.py:218
                     INFO     Gathering sentences for Word2Vec from training and validation sets...                                                                                                                                                                                            data.py:228
[05/06/25 03:07:54] INFO     Training Word2Vec on 12,355,830 sentences (dim=200, min_freq=5)...                                                                                                                                                                                                data.py:254
[05/06/25 03:24:11] SUCCESS  Word2Vec training complete. Vocab size: 90,460                                                                                                                                                                                                                   data.py:271
                     INFO     Caching Word2Vec model to cache\word2vec_model.gensim...                                                                                                                                                                                                     __main__.py:226
                     SUCCESS  Successfully cached Word2Vec model.                                                                                                                                                                                                                          __main__.py:229
                     INFO     Creating embedding matrix...                                                                                                                                                                                                                                 __main__.py:237
[05/06/25 03:24:12] INFO     Creating embedding matrix for 85,903 words...                                                                                                                                                                                                                    data.py:289
                     INFO     Set PAD token embedding (index 0) to zeros.                                                                                                                                                                                                                      data.py:306
                     INFO     Initialized 85,901 words (100.00%) in the embedding matrix from Word2Vec model.                                                                                                                                                                                data.py:310
                     INFO     UNK token (index 1) uses random initialization.                                                                                                                                                                                                                data.py:315
                     INFO     Determining max sequence lengths...                                                                                                                                                                                                                          __main__.py:243
                     INFO     Calculating maximum lengths across all data splits...                                                                                                                                                                                                            data.py:404
[05/06/25 03:24:14] INFO     Determined overall Max Sentence Length: 675                                                                                                                                                                                                                        data.py:420
                     INFO     Determined overall Max Document Length: 142                                                                                                                                                                                                                      data.py:421
                     INFO     Creating datasets and dataloaders...                                                                                                                                                                                                                         __main__.py:251
                     INFO     Created DataLoaders with batch size 64.                                                                                                                                                                                                                      __main__.py:273
                     INFO     Initializing HAN model...                                                                                                                                                                                                                                    __main__.py:276
[05/06/25 03:24:15] INFO     Model initialized:                                                                                                                                                                                                                                             __main__.py:287
                     INFO       - Trainable Parameters: 17,322,705                                                                                                                                                                                                                         __main__.py:288
                     INFO     Starting model training...                                                                                                                                                                                                                                   __main__.py:291
                     INFO     Starting training for up to 20 epochs...                                                                                                                                                                                                                       train.py:157
                     INFO       Optimizer: SGD (lr=0.01, momentum=0.9)                                                                                                                                                                                                                       train.py:158
                     INFO       Loss Function: CrossEntropyLoss                                                                                                                                                                                                                              train.py:159
                     INFO       Early Stopping Patience: 3                                                                                                                                                                                                                                   train.py:160
                     INFO       Models will be saved in: models                                                                                                                                                                                                                              train.py:161
Epoch 1/20 Training...   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00 0:54:28 Loss: 0.7485
[05/06/25 04:18:48] WARNING  Processed 19446/19616 batches in epoch 1.                                                                                                                                                                                                                        train.py:138
Epoch 1/20 Validation... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:05:59 Loss: 0.8009 Acc: 64.41%
[05/06/25 04:24:48] WARNING  Processed 2425/2452 batches during evaluation.                                                                                                                                                                                                               evaluate.py:128
                     INFO     Epoch 1/20 Summary: Train Loss: 0.8498, Val Loss: 0.8009, Val Acc: 64.41%                                                                                                                                                                                        train.py:191
                     SUCCESS  ✅ New best model saved to models\han_model_best.pt (Epoch 1, Accuracy: 64.41%)                                                                                                                                                                                  train.py:207
Epoch 2/20 Training...   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00 1:05:10 Loss: 0.7612
[05/06/25 05:29:58] WARNING  Processed 19446/19616 batches in epoch 2.                                                                                                                                                                                                                        train.py:138
Epoch 2/20 Validation... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:05:40 Loss: 0.7717 Acc: 65.85%
[05/06/25 05:35:39] WARNING  Processed 2425/2452 batches during evaluation.                                                                                                                                                                                                               evaluate.py:128
                     INFO     Epoch 2/20 Summary: Train Loss: 0.7728, Val Loss: 0.7717, Val Acc: 65.85%                                                                                                                                                                                        train.py:191
                     SUCCESS  ✅ New best model saved to models\han_model_best.pt (Epoch 2, Accuracy: 65.85%)                                                                                                                                                                                  train.py:207
Epoch 3/20 Training...   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00 0:51:11 Loss: 0.6713
[05/06/25 06:26:51] WARNING  Processed 19447/19616 batches in epoch 3.                                                                                                                                                                                                                        train.py:138
Epoch 3/20 Validation... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:02:41 Loss: 0.7441 Acc: 67.07%
[05/06/25 06:29:32] WARNING  Processed 2425/2452 batches during evaluation.                                                                                                                                                                                                               evaluate.py:128
                     INFO     Epoch 3/20 Summary: Train Loss: 0.7495, Val Loss: 0.7441, Val Acc: 67.07%                                                                                                                                                                                        train.py:191
[05/06/25 06:29:33] SUCCESS  ✅ New best model saved to models\han_model_best.pt (Epoch 3, Accuracy: 67.07%)                                                                                                                                                                                  train.py:207
Epoch 4/20 Training...   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00 0:29:01 Loss: 0.8375
[05/06/25 06:58:34] WARNING  Processed 19446/19616 batches in epoch 4.                                                                                                                                                                                                                        train.py:138
Epoch 4/20 Validation... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:02:42 Loss: 0.7331 Acc: 67.56%
[05/06/25 07:01:17] WARNING  Processed 2425/2452 batches during evaluation.                                                                                                                                                                                                               evaluate.py:128
                     INFO     Epoch 4/20 Summary: Train Loss: 0.7339, Val Loss: 0.7331, Val Acc: 67.56%                                                                                                                                                                                        train.py:191
                     SUCCESS  ✅ New best model saved to models\han_model_best.pt (Epoch 4, Accuracy: 67.56%)                                                                                                                                                                                  train.py:207
Epoch 5/20 Training...   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00 0:26:39 Loss: 0.7599
[05/06/25 07:27:56] WARNING  Processed 19447/19616 batches in epoch 5.                                                                                                                                                                                                                        train.py:138
Epoch 5/20 Validation... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:02:42 Loss: 0.7245 Acc: 67.99%
[05/06/25 07:30:38] WARNING  Processed 2425/2452 batches during evaluation.                                                                                                                                                                                                               evaluate.py:128
                     INFO     Epoch 5/20 Summary: Train Loss: 0.7220, Val Loss: 0.7245, Val Acc: 67.99%                                                                                                                                                                                        train.py:191
[05/06/25 07:30:39] SUCCESS  ✅ New best model saved to models\han_model_best.pt (Epoch 5, Accuracy: 67.99%)                                                                                                                                                                                  train.py:207
Epoch 6/20 Training...   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00 0:26:31 Loss: 0.5876
[05/06/25 07:57:10] WARNING  Processed 19448/19616 batches in epoch 6.                                                                                                                                                                                                                        train.py:138
Epoch 6/20 Validation... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:02:42 Loss: 0.7172 Acc: 68.34%
[05/06/25 07:59:52] WARNING  Processed 2425/2452 batches during evaluation.                                                                                                                                                                                                               evaluate.py:128
                     INFO     Epoch 6/20 Summary: Train Loss: 0.7125, Val Loss: 0.7172, Val Acc: 68.34%                                                                                                                                                                                        train.py:191
                     SUCCESS  ✅ New best model saved to models\han_model_best.pt (Epoch 6, Accuracy: 68.34%)                                                                                                                                                                                  train.py:207
Epoch 7/20 Training...   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00 0:26:42 Loss: 0.6468
[05/06/25 08:26:35] WARNING  Processed 19446/19616 batches in epoch 7.                                                                                                                                                                                                                        train.py:138
Epoch 7/20 Validation... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:02:39 Loss: 0.7131 Acc: 68.35%
[05/06/25 08:29:15] WARNING  Processed 2425/2452 batches during evaluation.                                                                                                                                                                                                               evaluate.py:128
                     INFO     Epoch 7/20 Summary: Train Loss: 0.7045, Val Loss: 0.7131, Val Acc: 68.35%                                                                                                                                                                                        train.py:191
                     SUCCESS  ✅ New best model saved to models\han_model_best.pt (Epoch 7, Accuracy: 68.35%)                                                                                                                                                                                  train.py:207
Epoch 8/20 Training...   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00 0:26:46 Loss: 0.8481
[05/06/25 08:56:02] WARNING  Processed 19446/19616 batches in epoch 8.                                                                                                                                                                                                                        train.py:138
Epoch 8/20 Validation... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:02:39 Loss: 0.7105 Acc: 68.52%
[05/06/25 08:58:42] WARNING  Processed 2425/2452 batches during evaluation.                                                                                                                                                                                                               evaluate.py:128
                     INFO     Epoch 8/20 Summary: Train Loss: 0.6978, Val Loss: 0.7105, Val Acc: 68.52%                                                                                                                                                                                        train.py:191
                     SUCCESS  ✅ New best model saved to models\han_model_best.pt (Epoch 8, Accuracy: 68.52%)                                                                                                                                                                                  train.py:207
Epoch 9/20 Training...   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00 0:26:48 Loss: 0.6559
[05/06/25 09:25:30] WARNING  Processed 19446/19616 batches in epoch 9.                                                                                                                                                                                                                        train.py:138
Epoch 9/20 Validation... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:02:37 Loss: 0.7127 Acc: 68.31%
[05/06/25 09:28:08] WARNING  Processed 2425/2452 batches during evaluation.                                                                                                                                                                                                               evaluate.py:128
                     INFO     Epoch 9/20 Summary: Train Loss: 0.6919, Val Loss: 0.7127, Val Acc: 68.31%                                                                                                                                                                                        train.py:191
                     INFO     Validation accuracy did not improve for 1 epoch(s).                                                                                                                                                                                                            train.py:216
Epoch 10/20 Training...  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00 0:27:58 Loss: 0.7744
[05/06/25 09:56:06] WARNING  Processed 19447/19616 batches in epoch 10.                                                                                                                                                                                                                       train.py:138
Epoch 10/20 Validation...━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:06:26 Loss: 0.7037 Acc: 68.75%
[05/06/25 10:02:33] WARNING  Processed 2425/2452 batches during evaluation.                                                                                                                                                                                                               evaluate.py:128
                     INFO     Epoch 10/20 Summary: Train Loss: 0.6867, Val Loss: 0.7037, Val Acc: 68.75%                                                                                                                                                                                       train.py:191
                     SUCCESS  ✅ New best model saved to models\han_model_best.pt (Epoch 10, Accuracy: 68.75%)                                                                                                                                                                                 train.py:207
Epoch 11/20 Training...  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% (This progress bar seems to be part of the previous epoch's validation, the actual training time/loss is missing from the provided log snippet for epoch 11 training start)
[05/06/25 10:51:56] WARNING  Processed 19447/19616 batches in epoch 11.                                                                                                                                                                                                                       train.py:138
Epoch 11/20 Validation...━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:03:26 Loss: 0.7041 Acc: 68.82%
[05/06/25 10:55:22] WARNING  Processed 2425/2452 batches during evaluation.                                                                                                                                                                                                               evaluate.py:128
                     INFO     Epoch 11/20 Summary: Train Loss: 0.6817, Val Loss: 0.7041, Val Acc: 68.82%                                                                                                                                                                                       train.py:191
                     SUCCESS  ✅ New best model saved to models\han_model_best.pt (Epoch 11, Accuracy: 68.82%)                                                                                                                                                                                 train.py:207
Epoch 12/20 Training...  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00 0:38:33 Loss: 0.5032
[05/06/25 11:33:56] WARNING  Processed 19446/19616 batches in epoch 12.                                                                                                                                                                                                                       train.py:138
Epoch 12/20 Validation...━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:02:34 Loss: 0.7007 Acc: 68.99%
[05/06/25 11:36:31] WARNING  Processed 2425/2452 batches during evaluation.                                                                                                                                                                                                               evaluate.py:128
                     INFO     Epoch 12/20 Summary: Train Loss: 0.6768, Val Loss: 0.7007, Val Acc: 68.99%                                                                                                                                                                                       train.py:191
                     SUCCESS  ✅ New best model saved to models\han_model_best.pt (Epoch 12, Accuracy: 68.99%)                                                                                                                                                                                 train.py:207
Epoch 13/20 Training...  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00 0:37:00 Loss: 0.6136
[05/06/25 12:13:32] WARNING  Processed 19447/19616 batches in epoch 13.                                                                                                                                                                                                                       train.py:138
Epoch 13/20 Validation...━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:03:24 Loss: 0.7027 Acc: 68.89%
[05/06/25 12:16:56] WARNING  Processed 2425/2452 batches during evaluation.                                                                                                                                                                                                               evaluate.py:128
                     INFO     Epoch 13/20 Summary: Train Loss: 0.6723, Val Loss: 0.7027, Val Acc: 68.89%                                                                                                                                                                                       train.py:191
                     INFO     Validation accuracy did not improve for 1 epoch(s).                                                                                                                                                                                                            train.py:216
Epoch 14/20 Training...  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00 0:37:51 Loss: 0.5636
[05/06/25 12:54:48] WARNING  Processed 19446/19616 batches in epoch 14.                                                                                                                                                                                                                       train.py:138
Epoch 14/20 Validation...━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:03:48 Loss: 0.6997 Acc: 69.04%
[05/06/25 12:58:37] WARNING  Processed 2425/2452 batches during evaluation.                                                                                                                                                                                                               evaluate.py:128
                     INFO     Epoch 14/20 Summary: Train Loss: 0.6681, Val Loss: 0.6997, Val Acc: 69.04%                                                                                                                                                                                       train.py:191
                     SUCCESS  ✅ New best model saved to models\han_model_best.pt (Epoch 14, Accuracy: 69.04%)                                                                                                                                                                                 train.py:207
Epoch 15/20 Training...  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00 0:32:20 Loss: 0.6921
[05/06/25 13:30:58] WARNING  Processed 19446/19616 batches in epoch 15.                                                                                                                                                                                                                       train.py:138
Epoch 15/20 Validation...━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:03:19 Loss: 0.7007 Acc: 68.92%
[05/06/25 13:34:17] WARNING  Processed 2425/2452 batches during evaluation.                                                                                                                                                                                                               evaluate.py:128
                     INFO     Epoch 15/20 Summary: Train Loss: 0.6639, Val Loss: 0.7007, Val Acc: 68.92%                                                                                                                                                                                       train.py:191
                     INFO     Validation accuracy did not improve for 1 epoch(s).                                                                                                                                                                                                            train.py:216
Epoch 16/20 Training...  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00 0:32:02 Loss: 0.6721
[05/06/25 14:06:20] WARNING  Processed 19446/19616 batches in epoch 16.                                                                                                                                                                                                                       train.py:138
Epoch 16/20 Validation...━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:04:02 Loss: 0.7055 Acc: 68.83%
[05/06/25 14:10:23] WARNING  Processed 2425/2452 batches during evaluation.                                                                                                                                                                                                               evaluate.py:128
                     INFO     Epoch 16/20 Summary: Train Loss: 0.6598, Val Loss: 0.7055, Val Acc: 68.83%                                                                                                                                                                                       train.py:191
                     INFO     Validation accuracy did not improve for 2 epoch(s).                                                                                                                                                                                                            train.py:216
Epoch 17/20 Training...  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00 0:36:51 Loss: 0.5899
[05/06/25 14:47:15] WARNING  Processed 19447/19616 batches in epoch 17.                                                                                                                                                                                                                       train.py:138
Epoch 17/20 Validation...━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:03:28 Loss: 0.7029 Acc: 68.94%
[05/06/25 14:50:43] WARNING  Processed 2425/2452 batches during evaluation.                                                                                                                                                                                                               evaluate.py:128
                     INFO     Epoch 17/20 Summary: Train Loss: 0.6559, Val Loss: 0.7029, Val Acc: 68.94%                                                                                                                                                                                       train.py:191
                     INFO     Validation accuracy did not improve for 3 epoch(s).                                                                                                                                                                                                            train.py:216
                     WARNING  ⏳ Early stopping triggered after 3 epochs without improvement.                                                                                                                                                                                                 train.py:220
                     SUCCESS  🏁 Training finished. Best validation accuracy: 69.04% achieved at Epoch 14.                                                                                                                                                                                    train.py:226
                     INFO     Loading best model weights for final evaluation...                                                                                                                                                                                                           __main__.py:306
                     INFO     Performing final evaluation on the test set...                                                                                                                                                                                                               __main__.py:313
Final Test Set...    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:03:25 Loss: 0.7011 Acc: 69.13%
[05/06/25 14:54:09] WARNING  Processed 2422/2452 batches during evaluation.                                                                                                                                                                                                               evaluate.py:128
                     INFO     --- Final Test Results ---                                                                                                                                                                                                                                   __main__.py:322
                     INFO      Loss:     0.7011                                                                                                                                                                                                                                           __main__.py:323
                     INFO      Accuracy: 69.13%                                                                                                                                                                                                                                           __main__.py:324
                     INFO     --------------------------                                                                                                                                                                                                                                 __main__.py:325
                     SUCCESS  Experiment finished.                                                                                                                                                                                                                                         __main__.py:326
PS C:\Projects\cs410-tech-review-final>